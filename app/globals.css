@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light mode (when not .dark) */
    --background: 248 250 252; /* slate-50 */
    --foreground: 15 23 42; /* slate-900 */
    --card: 255 255 255;
    --card-foreground: 15 23 42;
    --primary: 220 38 38; /* ClawLegion crimson */
    --primary-foreground: 255 255 255;
    --secondary: 241 245 249; /* slate-100 */
    --secondary-foreground: 30 41 59; /* slate-800 */
    --muted: 241 245 249;
    --muted-foreground: 100 116 139; /* slate-500 */
    --accent: 241 245 249;
    --accent-foreground: 15 23 42;
    --destructive: 239 68 68; /* red-500 */
    --destructive-foreground: 255 255 255;
    --border: 226 232 240; /* slate-200 */
    --input: 226 232 240;
    --ring: 220 38 38;
    --radius: 0.5rem;
  }

  .dark {
    /* Dark mode - primary palette */
    --background: 2 6 23; /* slate-950 */
    --foreground: 241 245 249; /* slate-100 */
    --card: 30 41 59; /* slate-800 */
    --card-foreground: 241 245 249;
    --primary: 220 38 38; /* ClawLegion crimson */
    --primary-foreground: 255 255 255;
    --secondary: 51 65 85; /* slate-700 */
    --secondary-foreground: 241 245 249;
    --muted: 51 65 85;
    --muted-foreground: 148 163 184; /* slate-400 */
    --accent: 51 65 85;
    --accent-foreground: 241 245 249;
    --destructive: 239 68 68;
    --destructive-foreground: 255 255 255;
    --border: 51 65 85; /* slate-700 */
    --input: 51 65 85;
    --ring: 220 38 38; /* ClawLegion crimson */

    /* ClawLegion Brand Tokens */
    --cl-crimson: #DC2626;
    --cl-crimson-hover: #B91C1C;
    --cl-crimson-muted: #7F1D1D;
    --cl-navy: #0F172A;
    --cl-navy-light: #1E293B;

    /* Glass surfaces */
    --glass-bg: rgb(255 255 255 / 0.03);
    --glass-border: rgb(255 255 255 / 0.06);
    --glass-1: rgb(255 255 255 / 0.03);
    --glass-2: rgb(255 255 255 / 0.06);
    --glass-3: rgb(255 255 255 / 0.10);

    /* Glow accents */
    --glow-primary: rgb(220 38 38 / 0.5);
    --glow-success: rgb(16 185 129 / 0.5);
    --glow-danger: rgb(239 68 68 / 0.5);
    --glow-purple: rgb(139 92 246 / 0.5);

    /* Shadow tokens */
    --shadow-glass: 0 4px 24px -1px rgb(0 0 0 / 0.3), 0 2px 8px -2px rgb(0 0 0 / 0.2);
    --shadow-glass-lg: 0 8px 40px -4px rgb(0 0 0 / 0.4), 0 4px 16px -4px rgb(0 0 0 / 0.3);
    --shadow-glow-blue: 0 0 20px -4px rgb(220 38 38 / 0.3);
    --shadow-glow-purple: 0 0 20px -4px rgb(139 92 246 / 0.3);
    --shadow-glow-crimson: 0 0 20px -4px rgb(220 38 38 / 0.4);
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    color-scheme: dark;
  }

  html.dark {
    color-scheme: dark;
  }

  html:not(.dark) {
    color-scheme: light;
  }

  body {
    @apply bg-background text-foreground antialiased;
  }
}

@layer utilities {
  /* Glass tiers — reduced blur on mobile for Chrome performance */
  .glass-1 {
    background: var(--glass-1);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .glass-2 {
    background: var(--glass-2);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--shadow-glass);
  }

  .glass-3 {
    background: var(--glass-3);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--shadow-glass-lg);
  }

  /* Mobile: reduce blur to prevent Chrome GPU saturation */
  @media (max-width: 768px) {
    .glass-1 {
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }
    .glass-2 {
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .glass-3 {
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
  }

  /* Backward compat: .glass is alias for glass-2 */
  .glass {
    background: var(--glass-2);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--shadow-glass);
  }

  .dark .glass {
    background: var(--glass-2);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--shadow-glass);
  }

  /* Glass inner highlight */
  .glass-inner-light {
    box-shadow: inset 0 1px 0 0 rgb(255 255 255 / 0.06);
  }

  /* Gradient shimmer border */
  .glass-gradient-border {
    position: relative;
  }

  .glass-gradient-border::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(
      135deg,
      rgb(255 255 255 / 0.1),
      rgb(255 255 255 / 0.02) 40%,
      rgb(255 255 255 / 0.02) 60%,
      rgb(255 255 255 / 0.1)
    );
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  /* Glow shadows */
  .glow-blue {
    box-shadow: var(--shadow-glow-blue);
  }

  .glow-purple {
    box-shadow: var(--shadow-glow-purple);
  }

  .glow-crimson {
    box-shadow: var(--shadow-glow-crimson);
  }

  /* Typography utilities */
  .heading-xl {
    @apply text-3xl sm:text-4xl font-bold tracking-tight text-white;
  }

  .heading-lg {
    @apply text-xl sm:text-2xl font-semibold tracking-tight text-white;
  }

  .heading-md {
    @apply text-lg font-semibold text-white;
  }

  .stat-value {
    font-family: var(--font-mono), ui-monospace, monospace;
    font-variant-numeric: tabular-nums;
  }

  .text-label {
    @apply text-xs uppercase tracking-wider text-slate-400;
  }

  /* Ambient background */
  .ambient-bg {
    background-color: #020617;
    background-image:
      radial-gradient(ellipse 80% 60% at 20% 0%, rgb(220 38 38 / 0.08), transparent),
      radial-gradient(ellipse 60% 50% at 80% 100%, rgb(139 92 246 / 0.06), transparent);
  }

  /* Custom scrollbar for dark mode */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 9999px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgb(255 255 255 / 0.1);
    border-radius: 9999px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgb(255 255 255 / 0.15);
  }

  .dark .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background: rgb(255 255 255 / 0.1);
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: rgb(255 255 255 / 0.15);
  }

  /* Status dot animations */
  @keyframes pulse-slow {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  .animate-pulse-slow {
    animation: pulse-slow 2s ease-in-out infinite;
  }

  /* Toast slide-in animation */
  @keyframes slide-in {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  /* Toast slide-out animation */
  @keyframes slide-out {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }

  .animate-slide-out {
    animation: slide-out 0.15s ease-in forwards;
  }

  .animate-slide-in {
    animation: slide-in 0.2s ease-out;
  }

  /* Gradient backgrounds */
  .gradient-dark {
    @apply bg-gradient-to-br from-slate-900 via-slate-950 to-slate-900;
  }

  /* Card hover effects */
  .card-hover {
    @apply transition-all duration-200 hover:scale-[1.02] hover:shadow-lg;
  }

  /* Status colors as utilities */
  .status-running {
    @apply text-blue-400 bg-blue-500/10;
  }

  .status-completed {
    @apply text-emerald-400 bg-emerald-500/10;
  }

  .status-failed {
    @apply text-red-400 bg-red-500/10;
  }

  .status-pending {
    @apply text-yellow-400 bg-yellow-500/10;
  }

  .status-paused {
    @apply text-orange-400 bg-orange-500/10;
  }

  /* Landing page animations */
  @keyframes fade-in-up {
    from { transform: translateY(8px); }
    to { transform: translateY(0); }
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.6s ease-out both;
  }

  .animate-delay-100 { animation-delay: 100ms; }
  .animate-delay-200 { animation-delay: 200ms; }
  .animate-delay-300 { animation-delay: 300ms; }
  .animate-delay-400 { animation-delay: 400ms; }
  .animate-delay-500 { animation-delay: 500ms; }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-12px); }
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  .landing-grid-bg {
    background-image:
      linear-gradient(rgb(255 255 255 / 0.02) 1px, transparent 1px),
      linear-gradient(90deg, rgb(255 255 255 / 0.02) 1px, transparent 1px);
    background-size: 64px 64px;
  }

  /* Sidebar active nav indicator */
  .nav-active-indicator {
    box-shadow: inset 3px 0 0 0 rgb(220 38 38);
    background: linear-gradient(to right, rgb(220 38 38 / 0.15), transparent);
  }

  /* CTA shimmer animation */
  @keyframes shimmer {
    0% { background-position: -200% center; }
    100% { background-position: 200% center; }
  }

  .shimmer-btn {
    position: relative;
    overflow: hidden;
  }

  .shimmer-btn::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgb(255 255 255 / 0.15) 50%,
      transparent 100%
    );
    background-size: 200% 100%;
    animation: shimmer 3s ease-in-out infinite;
    pointer-events: none;
  }

  /* Pipeline strip continuous scroll — starts centered, flows left-to-right */
  @keyframes slide-strip {
    0%   { transform: translateX(-75%); }
    100% { transform: translateX(-25%); }
  }

  .pipeline-strip {
    animation: slide-strip 60s linear infinite;
  }

  .pipeline-strip-mobile {
    animation: slide-strip 40s linear infinite;
  }

  /* Agent pipeline animations */
  @keyframes flow-particle {
    0% { left: 0%; opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { left: 100%; opacity: 0; }
  }

  .animate-flow-particle {
    animation: flow-particle 2s linear infinite;
  }

  @keyframes card-breathe {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
  }

  .animate-card-breathe {
    animation: card-breathe 4s ease-in-out infinite;
  }

  @keyframes glow-border-pulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.6; }
  }

  .animate-glow-border-pulse {
    animation: glow-border-pulse 3s ease-in-out infinite;
  }

  @keyframes pipeline-pulse {
    0%, 100% { opacity: 0.4; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.3); }
  }

  /* Flow builder edge dash animation */
  @keyframes flow-edge-dash {
    0% { stroke-dashoffset: 24; }
    100% { stroke-dashoffset: 0; }
  }

  .flow-edge-animated {
    stroke-dasharray: 8 4;
    animation: flow-edge-dash 0.6s linear infinite;
  }

  /* Node appear animation */
  @keyframes node-appear {
    0% { opacity: 0; transform: scale(0.8); }
    100% { opacity: 1; transform: scale(1); }
  }

  .animate-node-appear {
    animation: node-appear 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  }

  /* Activity entry fade-in */
  @keyframes fade-in-entry {
    from { transform: translateY(6px); }
    to { transform: translateY(0); }
  }

  .animate-fade-in-entry {
    animation: fade-in-entry 0.25s ease-out;
  }

  /* Simple fade-in for modals */
  @keyframes fade-in {
    from { opacity: 1; }
    to { opacity: 1; }
  }

  .animate-fade-in {
    animation: fade-in 0.2s ease-out;
  }

  /* Showcase slideshow animations */
  @keyframes showcase-slide-enter {
    from { transform: translateY(12px); }
    to { transform: translateY(0); }
  }

  .showcase-slide-enter {
    animation: showcase-slide-enter 0.5s cubic-bezier(0.16, 1, 0.3, 1) both;
  }

  .showcase-progress-bar {
    width: 0%;
    transition: none;
  }

  .showcase-progress-animate {
    width: 100%;
    transition: width 5.5s linear;
  }
}

/* MascotHero keyframes & classes */
@keyframes heroBob {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@keyframes heroGlow {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.mascot-hero-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
  height: 400px;
}

.council-hero-container {
  position: relative;
  width: 100%;
  height: 100%;
  animation: heroBob 4s ease-in-out infinite;
}

.council-hero-glow {
  position: absolute;
  inset: -30px;
  border-radius: 50%;
  background: radial-gradient(
    ellipse at center,
    rgba(220, 38, 38, 0.2) 0%,
    rgba(6, 182, 212, 0.12) 35%,
    rgba(67, 56, 202, 0.1) 55%,
    transparent 75%
  );
  animation: heroGlow 3s ease-in-out infinite;
  z-index: -1;
  filter: blur(20px);
}

.council-hero-image {
  filter: brightness(1.05) contrast(1.05);
}

@media (max-width: 768px) {
  .mascot-hero-wrapper {
    height: 243px;
    max-width: 100%;
  }
}

@media (max-width: 480px) {
  .mascot-hero-wrapper {
    height: 216px;
    max-width: 100%;
  }
}

/* Mobile: disable heavy continuous animations for faster paint + less GPU usage */
@media (max-width: 768px) {
  .council-hero-container { animation: none; }
  .council-hero-glow { animation: none; filter: blur(10px); opacity: 0.7; }
  .shimmer-btn::after { animation: none; display: none; }
  .animate-card-breathe { animation: none; }
  .animate-flow-particle { animation: none; display: none; }
  .animate-glow-border-pulse { animation: none; }
}

/* Reduced-motion: disable all continuous animations */
@media (prefers-reduced-motion: reduce) {
  .pipeline-strip,
  .pipeline-strip-mobile,
  .council-hero-container,
  .council-hero-glow,
  .animate-card-breathe,
  .animate-flow-particle,
  .animate-glow-border-pulse,
  .animate-float,
  .animate-pulse-slow {
    animation: none !important;
  }
  .shimmer-btn::after {
    animation: none !important;
    display: none !important;
  }
}

/* React Flow dark theme overrides — outside @layer so they beat the library styles */
.react-flow.dark {
  --xy-background-color-default: #0f172a;
  --xy-background-color: #0f172a;
}

.react-flow.dark .react-flow__controls {
  box-shadow: 0 4px 12px -2px rgb(0 0 0 / 0.5) !important;
  border: 1px solid rgb(255 255 255 / 0.08) !important;
  border-radius: 10px !important;
  overflow: hidden !important;
  background: transparent !important;
}

.react-flow.dark .react-flow__controls-button {
  background: rgb(15 23 42 / 0.95) !important;
  border: none !important;
  border-bottom: 1px solid rgb(255 255 255 / 0.06) !important;
  width: 34px !important;
  height: 34px !important;
}

.react-flow.dark .react-flow__controls-button svg {
  fill: rgb(148 163 184) !important;
}

.react-flow.dark .react-flow__controls-button:hover {
  background: rgb(30 41 59 / 0.95) !important;
}

.react-flow.dark .react-flow__controls-button:hover svg {
  fill: rgb(226 232 240) !important;
}

.react-flow.dark .react-flow__controls-button:last-child {
  border-bottom: none !important;
}

.react-flow__background {
  background-color: transparent !important;
}

.react-flow__node.selected > div {
  box-shadow: 0 0 16px -4px rgb(6 182 212 / 0.3);
}

/* Line clamp utilities */
.line-clamp-1 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 1;
}

.line-clamp-2 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
}

.line-clamp-3 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 3;
}

/* Chat collapse fix - expand content when chat sidebar is closed */
[data-chat-open="false"] .max-w-\[1600px\] {
  max-width: 100% !important;
}

/* Safe area insets for notched phones */
@supports (padding-top: env(safe-area-inset-top)) {
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-right {
    padding-right: env(safe-area-inset-right);
  }
}

/* Mobile navigation animations */
@keyframes slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes slide-from-left {
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
}

.animate-slide-up {
  animation: slide-up 0.2s ease-out;
}

.animate-slide-from-left {
  animation: slide-from-left 0.2s ease-out;
}

/* Hide scrollbar for horizontal scrollers */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari and Opera */
}

/* ═══════════════════════════════════════════════════════════════
   SWISS DESIGN SYSTEM — Alpine Clarity
   Philosophy: Function over form, objective communication,
   mathematical precision, high contrast, purposeful space.
   ═══════════════════════════════════════════════════════════════ */

@layer base {
  /* Swiss Design tokens — Easy Mode surfaces */
  :root {
    --swiss-bg: #FAFAFA;
    --swiss-surface: #FFFFFF;
    --swiss-surface-raised: #F7F7F8;
    --swiss-surface-sunken: #EBEBED;
    --swiss-border: #D4D4D8;
    --swiss-border-subtle: #EBEBED;
    --swiss-text-primary: #0A0A0A;
    --swiss-text-secondary: #52525B;
    --swiss-text-tertiary: #71717A;
    --swiss-text-muted: #A1A1AA;
    --swiss-accent: #2563EB;
    --swiss-accent-hover: #1D4ED8;
    --swiss-accent-muted: #DBEAFE;
    --swiss-success: #16A34A;
    --swiss-warning: #D97706;
    --swiss-error: #DC2626;
    --swiss-radius: 4px;
    --swiss-grid: 8px;
    --swiss-grid-half: 4px;
    --swiss-transition: 150ms cubic-bezier(0.25, 0.1, 0.25, 1);
  }

  .dark {
    --swiss-bg: #09090B;
    --swiss-surface: #18181B;
    --swiss-surface-raised: #27272A;
    --swiss-surface-sunken: #0F0F12;
    --swiss-border: #27272A;
    --swiss-border-subtle: #1E1E22;
    --swiss-text-primary: #FAFAFA;
    --swiss-text-secondary: #A1A1AA;
    --swiss-text-tertiary: #71717A;
    --swiss-text-muted: #52525B;
    --swiss-accent: #3B82F6;
    --swiss-accent-hover: #2563EB;
    --swiss-accent-muted: #1E3A5F;
    --swiss-success: #22C55E;
    --swiss-warning: #F59E0B;
    --swiss-error: #EF4444;
  }
}

@layer utilities {
  /* ─── Swiss Surface Utilities ─── */
  .swiss-surface {
    background-color: var(--swiss-surface);
    border: 1px solid var(--swiss-border);
    border-radius: var(--swiss-radius);
  }

  .swiss-surface-raised {
    background-color: var(--swiss-surface-raised);
    border: 1px solid var(--swiss-border-subtle);
    border-radius: var(--swiss-radius);
  }

  .swiss-surface-sunken {
    background-color: var(--swiss-surface-sunken);
    border-radius: var(--swiss-radius);
  }

  /* ─── Swiss Typography Utilities ─── */
  .swiss-heading {
    color: var(--swiss-text-primary);
    font-weight: 600;
    letter-spacing: -0.02em;
    line-height: 1.2;
  }

  .swiss-body {
    color: var(--swiss-text-secondary);
    font-weight: 400;
    letter-spacing: 0;
    line-height: 1.6;
  }

  .swiss-label {
    color: var(--swiss-text-tertiary);
    font-size: 11px;
    font-weight: 500;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    line-height: 16px;
  }

  .swiss-mono {
    font-family: var(--font-mono), ui-monospace, monospace;
    font-variant-numeric: tabular-nums;
    letter-spacing: -0.01em;
  }

  /* ─── Swiss Grid Utilities ─── */
  .swiss-grid-bg {
    background-image:
      linear-gradient(var(--swiss-border-subtle) 1px, transparent 1px),
      linear-gradient(90deg, var(--swiss-border-subtle) 1px, transparent 1px);
    background-size: var(--swiss-grid) var(--swiss-grid);
  }

  /* ─── Swiss Divider ─── */
  .swiss-divider {
    height: 1px;
    background-color: var(--swiss-border);
    border: none;
    margin: calc(var(--swiss-grid) * 3) 0;
  }

  /* ─── Swiss Focus Ring ─── */
  .swiss-focus {
    outline: 2px solid var(--swiss-accent);
    outline-offset: 2px;
  }

  /* ─── Swiss Transition ─── */
  .swiss-transition {
    transition: all var(--swiss-transition);
  }
}
